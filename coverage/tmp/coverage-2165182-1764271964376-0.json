{"result":[{"scriptId":"3","url":"node:internal/per_context/primordials","functions":[{"functionName":"SafeIterator","ranges":[{"startOffset":9162,"endOffset":9233,"count":1}],"isBlockCoverage":false},{"functionName":"next","ranges":[{"startOffset":9238,"endOffset":9287,"count":8}],"isBlockCoverage":false},{"functionName":"","ranges":[{"startOffset":10902,"endOffset":10969,"count":1}],"isBlockCoverage":false}]},{"scriptId":"7","url":"node:internal/errors","functions":[{"functionName":"prepareStackTraceCallback","ranges":[{"startOffset":3709,"endOffset":4840,"count":35}],"isBlockCoverage":false}]},{"scriptId":"9","url":"node:internal/bootstrap/node","functions":[{"functionName":"get","ranges":[{"startOffset":3814,"endOffset":3864,"count":2}],"isBlockCoverage":false},{"functionName":"set","ranges":[{"startOffset":3870,"endOffset":3928,"count":1}],"isBlockCoverage":false},{"functionName":"get","ranges":[{"startOffset":4054,"endOffset":4134,"count":2}],"isBlockCoverage":false},{"functionName":"set","ranges":[{"startOffset":4140,"endOffset":4536,"count":1}],"isBlockCoverage":false}]},{"scriptId":"10","url":"node:internal/timers","functions":[{"functionName":"initAsyncResource","ranges":[{"startOffset":5905,"endOffset":6246,"count":38}],"isBlockCoverage":false},{"functionName":"Timeout","ranges":[{"startOffset":6417,"endOffset":7916,"count":38}],"isBlockCoverage":false},{"functionName":"TimersList","ranges":[{"startOffset":8658,"endOffset":8964,"count":38}],"isBlockCoverage":false},{"functionName":"incRefCount","ranges":[{"startOffset":10341,"endOffset":10507,"count":38}],"isBlockCoverage":false},{"functionName":"decRefCount","ranges":[{"startOffset":10509,"endOffset":10676,"count":39}],"isBlockCoverage":false},{"functionName":"insert","ranges":[{"startOffset":11811,"endOffset":12550,"count":38}],"isBlockCoverage":false},{"functionName":"setPosition","ranges":[{"startOffset":13563,"endOffset":13634,"count":38}],"isBlockCoverage":false}]},{"scriptId":"11","url":"node:internal/async_hooks","functions":[{"functionName":"newAsyncId","ranges":[{"startOffset":14549,"endOffset":14619,"count":39}],"isBlockCoverage":false},{"functionName":"getDefaultTriggerAsyncId","ranges":[{"startOffset":14994,"endOffset":15284,"count":39}],"isBlockCoverage":false},{"functionName":"hasHooks","ranges":[{"startOffset":16096,"endOffset":16159,"count":82}],"isBlockCoverage":false},{"functionName":"enabledHooksExist","ranges":[{"startOffset":16161,"endOffset":16220,"count":1}],"isBlockCoverage":false},{"functionName":"initHooksExist","ranges":[{"startOffset":16222,"endOffset":16277,"count":39}],"isBlockCoverage":false},{"functionName":"destroyHooksExist","ranges":[{"startOffset":16338,"endOffset":16399,"count":40}],"isBlockCoverage":false},{"functionName":"emitBeforeScript","ranges":[{"startOffset":16890,"endOffset":17066,"count":1}],"isBlockCoverage":false},{"functionName":"emitAfterScript","ranges":[{"startOffset":17069,"endOffset":17189,"count":1}],"isBlockCoverage":false},{"functionName":"pushAsyncContext","ranges":[{"startOffset":17534,"endOffset":18104,"count":1}],"isBlockCoverage":false},{"functionName":"popAsyncContext","ranges":[{"startOffset":18169,"endOffset":18780,"count":1}],"isBlockCoverage":false}]},{"scriptId":"12","url":"node:internal/validators","functions":[{"functionName":"","ranges":[{"startOffset":2504,"endOffset":2885,"count":1}],"isBlockCoverage":false},{"functionName":"","ranges":[{"startOffset":13175,"endOffset":13291,"count":39}],"isBlockCoverage":false},{"functionName":"","ranges":[{"startOffset":15224,"endOffset":15414,"count":83}],"isBlockCoverage":false}]},{"scriptId":"13","url":"node:internal/util","functions":[{"functionName":"get","ranges":[{"startOffset":18301,"endOffset":18537,"count":77}],"isBlockCoverage":false}]},{"scriptId":"16","url":"node:internal/linkedlist","functions":[{"functionName":"remove","ranges":[{"startOffset":260,"endOffset":487,"count":77}],"isBlockCoverage":false},{"functionName":"append","ranges":[{"startOffset":543,"endOffset":995,"count":38}],"isBlockCoverage":false},{"functionName":"isEmpty","ranges":[{"startOffset":997,"endOffset":1057,"count":39}],"isBlockCoverage":false}]},{"scriptId":"17","url":"node:internal/priority_queue","functions":[{"functionName":"insert","ranges":[{"startOffset":692,"endOffset":875,"count":38}],"isBlockCoverage":false},{"functionName":"percolateUp","ranges":[{"startOffset":1739,"endOffset":2265,"count":38}],"isBlockCoverage":false},{"functionName":"removeAt","ranges":[{"startOffset":2269,"endOffset":2609,"count":39}],"isBlockCoverage":false}]},{"scriptId":"21","url":"node:internal/async_context_frame","functions":[{"functionName":"current","ranges":[{"startOffset":328,"endOffset":394,"count":40}],"isBlockCoverage":false},{"functionName":"set","ranges":[{"startOffset":405,"endOffset":470,"count":2}],"isBlockCoverage":false},{"functionName":"exchange","ranges":[{"startOffset":481,"endOffset":575,"count":1}],"isBlockCoverage":false}]},{"scriptId":"22","url":"node:events","functions":[{"functionName":"addCatch","ranges":[{"startOffset":9837,"endOffset":10396,"count":1}],"isBlockCoverage":false},{"functionName":"","ranges":[{"startOffset":10125,"endOffset":10335,"count":0}],"isBlockCoverage":false},{"functionName":"emit","ranges":[{"startOffset":12631,"endOffset":14923,"count":2}],"isBlockCoverage":false},{"functionName":"listenerCount","ranges":[{"startOffset":23556,"endOffset":24261,"count":1}],"isBlockCoverage":false}]},{"scriptId":"29","url":"node:internal/process/per_thread","functions":[{"functionName":"exit","ranges":[{"startOffset":6517,"endOffset":7513,"count":1}],"isBlockCoverage":false}]},{"scriptId":"31","url":"node:internal/process/task_queues","functions":[{"functionName":"setHasTickScheduled","ranges":[{"startOffset":1196,"endOffset":1282,"count":1}],"isBlockCoverage":false},{"functionName":"processTicksAndRejections","ranges":[{"startOffset":1582,"endOffset":2706,"count":1}],"isBlockCoverage":false},{"functionName":"nextTick","ranges":[{"startOffset":2850,"endOffset":3780,"count":1}],"isBlockCoverage":false}]},{"scriptId":"33","url":"node:internal/fixed_queue","functions":[{"functionName":"isEmpty","ranges":[{"startOffset":3130,"endOffset":3182,"count":3}],"isBlockCoverage":false},{"functionName":"isFull","ranges":[{"startOffset":3186,"endOffset":3253,"count":1}],"isBlockCoverage":false},{"functionName":"push","ranges":[{"startOffset":3257,"endOffset":3344,"count":1}],"isBlockCoverage":false},{"functionName":"shift","ranges":[{"startOffset":3348,"endOffset":3563,"count":2}],"isBlockCoverage":false},{"functionName":"isEmpty","ranges":[{"startOffset":3683,"endOffset":3730,"count":1}],"isBlockCoverage":false},{"functionName":"push","ranges":[{"startOffset":3734,"endOffset":3998,"count":1}],"isBlockCoverage":false},{"functionName":"shift","ranges":[{"startOffset":4002,"endOffset":4257,"count":2}],"isBlockCoverage":false}]},{"scriptId":"35","url":"node:timers","functions":[{"functionName":"unenroll","ranges":[{"startOffset":2127,"endOffset":3311,"count":39}],"isBlockCoverage":false},{"functionName":"setTimeout","ranges":[{"startOffset":3510,"endOffset":3753,"count":38}],"isBlockCoverage":false},{"functionName":"clearTimeout","ranges":[{"startOffset":4048,"endOffset":4406,"count":39}],"isBlockCoverage":false}]},{"scriptId":"37","url":"node:path","functions":[{"functionName":"","ranges":[{"startOffset":36979,"endOffset":36998,"count":2}],"isBlockCoverage":false},{"functionName":"resolve","ranges":[{"startOffset":37123,"endOffset":38452,"count":2}],"isBlockCoverage":false},{"functionName":"join","ranges":[{"startOffset":39423,"endOffset":39787,"count":3}],"isBlockCoverage":false},{"functionName":"relative","ranges":[{"startOffset":39877,"endOffset":42237,"count":2}],"isBlockCoverage":false}]},{"scriptId":"46","url":"node:internal/source_map/source_map_cache","functions":[{"functionName":"sourceMapCacheToObject","ranges":[{"startOffset":11994,"endOffset":12391,"count":1}],"isBlockCoverage":false}]},{"scriptId":"48","url":"node:fs","functions":[{"functionName":"existsSync","ranges":[{"startOffset":6704,"endOffset":7110,"count":1}],"isBlockCoverage":false}]},{"scriptId":"65","url":"node:internal/modules/cjs/loader","functions":[{"functionName":"updateChildren","ranges":[{"startOffset":7894,"endOffset":8096,"count":1}],"isBlockCoverage":false},{"functionName":"trySelfParentPath","ranges":[{"startOffset":16466,"endOffset":16759,"count":1}],"isBlockCoverage":false},{"functionName":"","ranges":[{"startOffset":19344,"endOffset":22963,"count":1}],"isBlockCoverage":false},{"functionName":"","ranges":[{"startOffset":26363,"endOffset":27650,"count":1}],"isBlockCoverage":false},{"functionName":"","ranges":[{"startOffset":36439,"endOffset":40743,"count":1}],"isBlockCoverage":false},{"functionName":"","ranges":[{"startOffset":41272,"endOffset":44216,"count":1}],"isBlockCoverage":false}]},{"scriptId":"77","url":"node:internal/child_process","functions":[{"functionName":"channel.onread","ranges":[{"startOffset":15933,"endOffset":17112,"count":1},{"startOffset":16267,"endOffset":16294,"count":0},{"startOffset":16616,"endOffset":16849,"count":0},{"startOffset":16932,"endOffset":17108,"count":0}],"isBlockCoverage":true},{"functionName":"target.send","ranges":[{"startOffset":20063,"endOffset":20783,"count":6},{"startOffset":20148,"endOffset":20233,"count":0},{"startOffset":20274,"endOffset":20334,"count":0},{"startOffset":20367,"endOffset":20416,"count":0},{"startOffset":20563,"endOffset":20782,"count":0}],"isBlockCoverage":true},{"functionName":"","ranges":[{"startOffset":20725,"endOffset":20753,"count":0}],"isBlockCoverage":false},{"functionName":"target._send","ranges":[{"startOffset":20803,"endOffset":24930,"count":6},{"startOffset":20876,"endOffset":20891,"count":0},{"startOffset":20932,"endOffset":20970,"count":0},{"startOffset":21294,"endOffset":21332,"count":0},{"startOffset":21333,"endOffset":21372,"count":0},{"startOffset":21374,"endOffset":21491,"count":0},{"startOffset":21572,"endOffset":21623,"count":0},{"startOffset":21700,"endOffset":23304,"count":0},{"startOffset":23332,"endOffset":23466,"count":0},{"startOffset":23468,"endOffset":23740,"count":0},{"startOffset":23947,"endOffset":24085,"count":0},{"startOffset":24112,"endOffset":24303,"count":0},{"startOffset":24345,"endOffset":24396,"count":0},{"startOffset":24402,"endOffset":24802,"count":0}],"isBlockCoverage":true},{"functionName":"req.oncomplete","ranges":[{"startOffset":24139,"endOffset":24264,"count":0}],"isBlockCoverage":false},{"functionName":"","ranges":[{"startOffset":24748,"endOffset":24776,"count":0}],"isBlockCoverage":false},{"functionName":"emit","ranges":[{"startOffset":26576,"endOffset":26860,"count":1},{"startOffset":26752,"endOffset":26859,"count":0}],"isBlockCoverage":true},{"functionName":"handleMessage","ranges":[{"startOffset":26864,"endOffset":27082,"count":1},{"startOffset":26947,"endOffset":26954,"count":0},{"startOffset":26988,"endOffset":27007,"count":0}],"isBlockCoverage":true},{"functionName":"isInternal","ranges":[{"startOffset":27161,"endOffset":27471,"count":1},{"startOffset":27305,"endOffset":27361,"count":0},{"startOffset":27362,"endOffset":27467,"count":0}],"isBlockCoverage":true}]},{"scriptId":"91","url":"node:string_decoder","functions":[{"functionName":"write","ranges":[{"startOffset":2545,"endOffset":2930,"count":1},{"startOffset":2602,"endOffset":2613,"count":0},{"startOffset":2649,"endOffset":2800,"count":0},{"startOffset":2830,"endOffset":2884,"count":0}],"isBlockCoverage":true}]},{"scriptId":"104","url":"node:internal/child_process/serialization","functions":[{"functionName":"parseChannelMessages","ranges":[{"startOffset":4629,"endOffset":5413,"count":1},{"startOffset":4703,"endOffset":4710,"count":0},{"startOffset":4765,"endOffset":4817,"count":0},{"startOffset":5099,"endOffset":5153,"count":0}],"isBlockCoverage":true},{"functionName":"writeChannelMessage","ranges":[{"startOffset":5418,"endOffset":5581,"count":6}],"isBlockCoverage":true}]},{"scriptId":"108","url":"file:///home/invisible/projects/url-redirector/node_modules/playwright/lib/common/process.js","functions":[{"functionName":"dispatchEvent","ranges":[{"startOffset":1093,"endOffset":1240,"count":4}],"isBlockCoverage":true},{"functionName":"","ranges":[{"startOffset":1579,"endOffset":2832,"count":1},{"startOffset":1637,"endOffset":1969,"count":0},{"startOffset":2365,"endOffset":2830,"count":0},{"startOffset":2543,"endOffset":2662,"count":1}],"isBlockCoverage":true},{"functionName":"","ranges":[{"startOffset":2152,"endOffset":2198,"count":106}],"isBlockCoverage":true},{"functionName":"","ranges":[{"startOffset":2204,"endOffset":2244,"count":5},{"startOffset":2236,"endOffset":2243,"count":0}],"isBlockCoverage":true},{"functionName":"gracefullyCloseAndExit","ranges":[{"startOffset":2910,"endOffset":3355,"count":1},{"startOffset":2977,"endOffset":2999,"count":0},{"startOffset":3001,"endOffset":3095,"count":0}],"isBlockCoverage":true},{"functionName":"","ranges":[{"startOffset":3049,"endOffset":3070,"count":0}],"isBlockCoverage":false},{"functionName":"","ranges":[{"startOffset":3211,"endOffset":3224,"count":0}],"isBlockCoverage":false},{"functionName":"","ranges":[{"startOffset":3311,"endOffset":3326,"count":0}],"isBlockCoverage":false},{"functionName":"sendMessageToParent","ranges":[{"startOffset":3356,"endOffset":3528,"count":6},{"startOffset":3435,"endOffset":3526,"count":0}],"isBlockCoverage":true}]},{"scriptId":"122","url":"file:///home/invisible/projects/url-redirector/node_modules/playwright-core/lib/utils/isomorphic/manualPromise.js","functions":[{"functionName":"get","ranges":[{"startOffset":597,"endOffset":612,"count":39}],"isBlockCoverage":true},{"functionName":"ManualPromise","ranges":[{"startOffset":928,"endOffset":947,"count":39}],"isBlockCoverage":true},{"functionName":"ManualPromise","ranges":[{"startOffset":1095,"endOffset":1296,"count":39}],"isBlockCoverage":true},{"functionName":"","ranges":[{"startOffset":1154,"endOffset":1208,"count":39}],"isBlockCoverage":true},{"functionName":"isDone","ranges":[{"startOffset":1299,"endOffset":1338,"count":30}],"isBlockCoverage":true},{"functionName":"resolve","ranges":[{"startOffset":1341,"endOffset":1404,"count":30}],"isBlockCoverage":true},{"functionName":"","ranges":[{"startOffset":1478,"endOffset":1526,"count":39}],"isBlockCoverage":true}]},{"scriptId":"123","url":"file:///home/invisible/projects/url-redirector/node_modules/playwright-core/lib/utils/isomorphic/stackTrace.js","functions":[{"functionName":"captureRawStack","ranges":[{"startOffset":878,"endOffset":899,"count":35}],"isBlockCoverage":true},{"functionName":"captureRawStack","ranges":[{"startOffset":1187,"endOffset":1431,"count":35},{"startOffset":1352,"endOffset":1357,"count":0}],"isBlockCoverage":true},{"functionName":"parseStackFrame","ranges":[{"startOffset":1432,"endOffset":2805,"count":379},{"startOffset":1563,"endOffset":1575,"count":35},{"startOffset":1575,"endOffset":1640,"count":344},{"startOffset":1640,"endOffset":1652,"count":0},{"startOffset":1652,"endOffset":1744,"count":344},{"startOffset":1750,"endOffset":1762,"count":6},{"startOffset":1762,"endOffset":2028,"count":338},{"startOffset":2028,"endOffset":2035,"count":309},{"startOffset":2037,"endOffset":2503,"count":309},{"startOffset":2105,"endOffset":2499,"count":27297},{"startOffset":2141,"endOffset":2168,"count":0},{"startOffset":2201,"endOffset":2230,"count":0},{"startOffset":2232,"endOffset":2493,"count":0},{"startOffset":2503,"endOffset":2517,"count":338},{"startOffset":2517,"endOffset":2620,"count":309},{"startOffset":2593,"endOffset":2616,"count":0},{"startOffset":2620,"endOffset":2746,"count":338},{"startOffset":2677,"endOffset":2719,"count":0},{"startOffset":2746,"endOffset":2764,"count":338},{"startOffset":2764,"endOffset":2787,"count":309},{"startOffset":2787,"endOffset":2804,"count":338}],"isBlockCoverage":true}]},{"scriptId":"130","url":"file:///home/invisible/projects/url-redirector/node_modules/playwright-core/lib/utils/isomorphic/time.js","functions":[{"functionName":"get","ranges":[{"startOffset":597,"endOffset":612,"count":123}],"isBlockCoverage":true},{"functionName":"monotonicTime","ranges":[{"startOffset":1006,"endOffset":1025,"count":123}],"isBlockCoverage":true},{"functionName":"monotonicTime","ranges":[{"startOffset":1362,"endOffset":1457,"count":123}],"isBlockCoverage":true}]},{"scriptId":"135","url":"node:internal/perf/performance","functions":[{"functionName":"now","ranges":[{"startOffset":3600,"endOffset":3700,"count":123}],"isBlockCoverage":true}]},{"scriptId":"150","url":"file:///home/invisible/projects/url-redirector/node_modules/playwright-core/lib/utilsBundleImpl/index.js","functions":[{"functionName":"y","ranges":[{"startOffset":11206,"endOffset":11598,"count":1},{"startOffset":11244,"endOffset":11280,"count":0},{"startOffset":11354,"endOffset":11371,"count":0},{"startOffset":11578,"endOffset":11585,"count":0}],"isBlockCoverage":true},{"functionName":"","ranges":[{"startOffset":11414,"endOffset":11547,"count":0}],"isBlockCoverage":false},{"functionName":"get","ranges":[{"startOffset":11770,"endOffset":11838,"count":78},{"startOffset":11782,"endOffset":11784,"count":0},{"startOffset":11802,"endOffset":11835,"count":0}],"isBlockCoverage":true}]},{"scriptId":"213","url":"file:///home/invisible/projects/url-redirector/node_modules/playwright-core/lib/server/utils/fileUtils.js","functions":[{"functionName":"get","ranges":[{"startOffset":669,"endOffset":684,"count":1}],"isBlockCoverage":true},{"functionName":"sanitizeForFilePath","ranges":[{"startOffset":1719,"endOffset":1744,"count":1}],"isBlockCoverage":true},{"functionName":"sanitizeForFilePath","ranges":[{"startOffset":2842,"endOffset":2955,"count":1}],"isBlockCoverage":true}]},{"scriptId":"231","url":"file:///home/invisible/projects/url-redirector/node_modules/playwright-core/lib/server/utils/processLauncher.js","functions":[{"functionName":"get","ranges":[{"startOffset":669,"endOffset":684,"count":1}],"isBlockCoverage":true},{"functionName":"gracefullyCloseAll","ranges":[{"startOffset":1532,"endOffset":1556,"count":1}],"isBlockCoverage":true},{"functionName":"gracefullyCloseAll","ranges":[{"startOffset":2101,"endOffset":2257,"count":1}],"isBlockCoverage":true},{"functionName":"","ranges":[{"startOffset":2194,"endOffset":2252,"count":0}],"isBlockCoverage":false}]},{"scriptId":"236","url":"file:///home/invisible/projects/url-redirector/node_modules/playwright-core/lib/server/utils/profiler.js","functions":[{"functionName":"get","ranges":[{"startOffset":669,"endOffset":684,"count":1}],"isBlockCoverage":true},{"functionName":"stopProfiling","ranges":[{"startOffset":1509,"endOffset":1528,"count":1}],"isBlockCoverage":true},{"functionName":"stopProfiling","ranges":[{"startOffset":2002,"endOffset":2390,"count":1},{"startOffset":2076,"endOffset":2389,"count":0}],"isBlockCoverage":true},{"functionName":"","ranges":[{"startOffset":2097,"endOffset":2386,"count":0}],"isBlockCoverage":false}]},{"scriptId":"240","url":"file:///home/invisible/projects/url-redirector/node_modules/playwright-core/lib/server/utils/userAgent.js","functions":[{"functionName":"get","ranges":[{"startOffset":669,"endOffset":684,"count":1}],"isBlockCoverage":true},{"functionName":"getPlaywrightVersion","ranges":[{"startOffset":1520,"endOffset":1546,"count":1}],"isBlockCoverage":true},{"functionName":"getPlaywrightVersion","ranges":[{"startOffset":3769,"endOffset":4001,"count":1},{"startOffset":3946,"endOffset":3988,"count":0}],"isBlockCoverage":true}]},{"scriptId":"243","url":"file:///home/invisible/projects/url-redirector/node_modules/playwright/lib/util.js","functions":[{"functionName":"get","ranges":[{"startOffset":669,"endOffset":684,"count":115}],"isBlockCoverage":true},{"functionName":"debugTest","ranges":[{"startOffset":1775,"endOffset":1790,"count":78}],"isBlockCoverage":true},{"functionName":"filteredStackTrace","ranges":[{"startOffset":2050,"endOffset":2074,"count":35}],"isBlockCoverage":true},{"functionName":"trimLongString","ranges":[{"startOffset":2808,"endOffset":2828,"count":1}],"isBlockCoverage":true},{"functionName":"windowsFilesystemFriendlyLength","ranges":[{"startOffset":2865,"endOffset":2902,"count":1}],"isBlockCoverage":true},{"functionName":"filterStackFile","ranges":[{"startOffset":3934,"endOffset":4165,"count":338},{"startOffset":4057,"endOffset":4129,"count":0},{"startOffset":4135,"endOffset":4164,"count":0}],"isBlockCoverage":true},{"functionName":"filteredStackTrace","ranges":[{"startOffset":4166,"endOffset":4518,"count":35},{"startOffset":4258,"endOffset":4499,"count":379},{"startOffset":4386,"endOffset":4400,"count":338},{"startOffset":4408,"endOffset":4417,"count":41},{"startOffset":4417,"endOffset":4471,"count":338},{"startOffset":4471,"endOffset":4499,"count":0}],"isBlockCoverage":true},{"functionName":"","ranges":[{"startOffset":5726,"endOffset":6277,"count":1},{"startOffset":5771,"endOffset":5852,"count":0},{"startOffset":5895,"endOffset":6093,"count":0},{"startOffset":6134,"endOffset":6255,"count":0}],"isBlockCoverage":true},{"functionName":"trimLongString","ranges":[{"startOffset":7851,"endOffset":8193,"count":1},{"startOffset":7933,"endOffset":8192,"count":0}],"isBlockCoverage":true}]},{"scriptId":"244","url":"file:///home/invisible/projects/url-redirector/node_modules/playwright/lib/worker/workerMain.js","functions":[{"functionName":"_stop","ranges":[{"startOffset":3962,"endOffset":4108,"count":1},{"startOffset":4053,"endOffset":4065,"count":0}],"isBlockCoverage":true},{"functionName":"gracefullyClose","ranges":[{"startOffset":4111,"endOffset":5277,"count":1},{"startOffset":4198,"endOffset":4223,"count":0},{"startOffset":4942,"endOffset":5025,"count":0},{"startOffset":5060,"endOffset":5273,"count":0}],"isBlockCoverage":true},{"functionName":"runnable.type","ranges":[{"startOffset":4338,"endOffset":4353,"count":0}],"isBlockCoverage":false},{"functionName":"runnable.type","ranges":[{"startOffset":4355,"endOffset":4370,"count":0}],"isBlockCoverage":false},{"functionName":"runnable.type","ranges":[{"startOffset":4372,"endOffset":4387,"count":0}],"isBlockCoverage":false},{"functionName":"","ranges":[{"startOffset":4389,"endOffset":4404,"count":0}],"isBlockCoverage":false},{"functionName":"","ranges":[{"startOffset":4503,"endOffset":4529,"count":1}],"isBlockCoverage":true},{"functionName":"","ranges":[{"startOffset":4537,"endOffset":4552,"count":0}],"isBlockCoverage":false},{"functionName":"","ranges":[{"startOffset":4639,"endOffset":4654,"count":0}],"isBlockCoverage":false},{"functionName":"","ranges":[{"startOffset":4743,"endOffset":4758,"count":0}],"isBlockCoverage":false},{"functionName":"","ranges":[{"startOffset":4812,"endOffset":4856,"count":1}],"isBlockCoverage":true},{"functionName":"","ranges":[{"startOffset":4864,"endOffset":4879,"count":0}],"isBlockCoverage":false},{"functionName":"_loadIfNeeded","ranges":[{"startOffset":6940,"endOffset":7471,"count":1},{"startOffset":6999,"endOffset":7470,"count":0}],"isBlockCoverage":true},{"functionName":"","ranges":[{"startOffset":7131,"endOffset":7169,"count":0}],"isBlockCoverage":true},{"functionName":"runTestGroup","ranges":[{"startOffset":7474,"endOffset":9648,"count":0},{"startOffset":8728,"endOffset":8821,"count":1},{"startOffset":9049,"endOffset":9644,"count":1},{"startOffset":9351,"endOffset":9361,"count":0},{"startOffset":9371,"endOffset":9478,"count":0}],"isBlockCoverage":true},{"functionName":"_runTest","ranges":[{"startOffset":10032,"endOffset":17195,"count":0},{"startOffset":15283,"endOffset":15321,"count":1},{"startOffset":15344,"endOffset":15370,"count":1},{"startOffset":16452,"endOffset":17016,"count":1}],"isBlockCoverage":true},{"functionName":"","ranges":[{"startOffset":10298,"endOffset":10363,"count":2}],"isBlockCoverage":true},{"functionName":"","ranges":[{"startOffset":14078,"endOffset":15260,"count":0},{"startOffset":14778,"endOffset":14787,"count":1},{"startOffset":14872,"endOffset":14915,"count":1},{"startOffset":14915,"endOffset":15186,"count":2},{"startOffset":14952,"endOffset":14976,"count":0},{"startOffset":15075,"endOffset":15168,"count":0},{"startOffset":15186,"endOffset":15227,"count":1}],"isBlockCoverage":true},{"functionName":"","ranges":[{"startOffset":16605,"endOffset":16670,"count":1}],"isBlockCoverage":true},{"functionName":"_collectHooksAndModifiers","ranges":[{"startOffset":17198,"endOffset":18030,"count":2},{"startOffset":17320,"endOffset":17930,"count":0}],"isBlockCoverage":true},{"functionName":"fn","ranges":[{"startOffset":17527,"endOffset":17704,"count":0}],"isBlockCoverage":false},{"functionName":"","ranges":[{"startOffset":17973,"endOffset":18001,"count":1}],"isBlockCoverage":true},{"functionName":"_runAllHooksForSuite","ranges":[{"startOffset":18315,"endOffset":19682,"count":2},{"startOffset":18483,"endOffset":19634,"count":0},{"startOffset":19661,"endOffset":19678,"count":0}],"isBlockCoverage":true},{"functionName":"","ranges":[{"startOffset":18597,"endOffset":19318,"count":0}],"isBlockCoverage":false},{"functionName":"_runAfterAllHooksForSuite","ranges":[{"startOffset":19685,"endOffset":19897,"count":2},{"startOffset":19782,"endOffset":19789,"count":0}],"isBlockCoverage":true},{"functionName":"buildTestEndPayload","ranges":[{"startOffset":20868,"endOffset":21218,"count":1}],"isBlockCoverage":true}]},{"scriptId":"246","url":"file:///home/invisible/projects/url-redirector/node_modules/playwright/lib/transform/transform.js","functions":[{"functionName":"get","ranges":[{"startOffset":669,"endOffset":684,"count":39}],"isBlockCoverage":true},{"functionName":"wrapFunctionWithLocation","ranges":[{"startOffset":1858,"endOffset":1888,"count":39}],"isBlockCoverage":true},{"functionName":"resolveHook","ranges":[{"startOffset":4897,"endOffset":7088,"count":1},{"startOffset":5009,"endOffset":5016,"count":0},{"startOffset":5062,"endOffset":5327,"count":0},{"startOffset":5428,"endOffset":7086,"count":0}],"isBlockCoverage":true},{"functionName":"shouldTransform","ranges":[{"startOffset":7089,"endOffset":7250,"count":1},{"startOffset":7164,"endOffset":7177,"count":0}],"isBlockCoverage":true},{"functionName":"resolveFilename","ranges":[{"startOffset":9863,"endOffset":10145,"count":1},{"startOffset":10039,"endOffset":10060,"count":0}],"isBlockCoverage":true},{"functionName":"wrapFunctionWithLocation","ranges":[{"startOffset":10715,"endOffset":11587,"count":39}],"isBlockCoverage":true},{"functionName":"","ranges":[{"startOffset":10766,"endOffset":11584,"count":0}],"isBlockCoverage":true}]},{"scriptId":"253","url":"file:///home/invisible/projects/url-redirector/node_modules/playwright/lib/utilsBundleImpl.js","functions":[{"functionName":"ri","ranges":[{"startOffset":56129,"endOffset":56329,"count":1},{"startOffset":56164,"endOffset":56167,"count":0},{"startOffset":56182,"endOffset":56328,"count":0}],"isBlockCoverage":true},{"functionName":"wc","ranges":[{"startOffset":56422,"endOffset":56503,"count":344},{"startOffset":56499,"endOffset":56502,"count":0}],"isBlockCoverage":true},{"functionName":"","ranges":[{"startOffset":56720,"endOffset":56800,"count":2},{"startOffset":56759,"endOffset":56788,"count":3},{"startOffset":56779,"endOffset":56787,"count":0}],"isBlockCoverage":true},{"functionName":"","ranges":[{"startOffset":56823,"endOffset":57159,"count":1},{"startOffset":56865,"endOffset":56932,"count":0},{"startOffset":56941,"endOffset":56954,"count":0},{"startOffset":56989,"endOffset":57020,"count":0},{"startOffset":57021,"endOffset":57136,"count":0},{"startOffset":57137,"endOffset":57144,"count":0}],"isBlockCoverage":true},{"functionName":"","ranges":[{"startOffset":56900,"endOffset":56930,"count":0}],"isBlockCoverage":false},{"functionName":"vc","ranges":[{"startOffset":57397,"endOffset":57800,"count":1},{"startOffset":57426,"endOffset":57622,"count":0},{"startOffset":57777,"endOffset":57781,"count":0},{"startOffset":57789,"endOffset":57794,"count":0}],"isBlockCoverage":true},{"functionName":"","ranges":[{"startOffset":57822,"endOffset":58000,"count":1},{"startOffset":57864,"endOffset":57999,"count":0}],"isBlockCoverage":true},{"functionName":"ni","ranges":[{"startOffset":58002,"endOffset":58428,"count":344},{"startOffset":58042,"endOffset":58269,"count":1},{"startOffset":58063,"endOffset":58233,"count":0},{"startOffset":58280,"endOffset":58326,"count":0},{"startOffset":58327,"endOffset":58419,"count":0}],"isBlockCoverage":true},{"functionName":"","ranges":[{"startOffset":58154,"endOffset":58231,"count":0}],"isBlockCoverage":true},{"functionName":"xc","ranges":[{"startOffset":58705,"endOffset":59359,"count":344},{"startOffset":58749,"endOffset":58760,"count":0},{"startOffset":58801,"endOffset":58850,"count":0},{"startOffset":58857,"endOffset":58874,"count":0},{"startOffset":59050,"endOffset":59053,"count":274},{"startOffset":59060,"endOffset":59276,"count":274},{"startOffset":59107,"endOffset":59119,"count":0},{"startOffset":59148,"endOffset":59247,"count":239},{"startOffset":59168,"endOffset":59180,"count":233},{"startOffset":59187,"endOffset":59226,"count":233},{"startOffset":59226,"endOffset":59246,"count":0},{"startOffset":59247,"endOffset":59275,"count":35},{"startOffset":59276,"endOffset":59331,"count":70},{"startOffset":59282,"endOffset":59311,"count":0},{"startOffset":59313,"endOffset":59318,"count":41},{"startOffset":59318,"endOffset":59330,"count":29},{"startOffset":59339,"endOffset":59356,"count":315}],"isBlockCoverage":true},{"functionName":"","ranges":[{"startOffset":59451,"endOffset":59527,"count":7912},{"startOffset":59489,"endOffset":59521,"count":7224},{"startOffset":59521,"endOffset":59526,"count":688}],"isBlockCoverage":true},{"functionName":"e.<computed>","ranges":[{"startOffset":59490,"endOffset":59521,"count":1924}],"isBlockCoverage":true},{"functionName":"qn","ranges":[{"startOffset":59545,"endOffset":60375,"count":344},{"startOffset":59575,"endOffset":59617,"count":0},{"startOffset":59631,"endOffset":59659,"count":0},{"startOffset":59680,"endOffset":59710,"count":0},{"startOffset":59861,"endOffset":59864,"count":0},{"startOffset":59870,"endOffset":59903,"count":0},{"startOffset":60272,"endOffset":60307,"count":0},{"startOffset":60316,"endOffset":60372,"count":0}],"isBlockCoverage":true},{"functionName":"t.getFunctionName","ranges":[{"startOffset":60014,"endOffset":60082,"count":344},{"startOffset":60052,"endOffset":60056,"count":35},{"startOffset":60056,"endOffset":60081,"count":309}],"isBlockCoverage":true},{"functionName":"t.getFileName","ranges":[{"startOffset":60097,"endOffset":60124,"count":0}],"isBlockCoverage":true},{"functionName":"t.getLineNumber","ranges":[{"startOffset":60141,"endOffset":60166,"count":344}],"isBlockCoverage":true},{"functionName":"t.getColumnNumber","ranges":[{"startOffset":60185,"endOffset":60214,"count":344}],"isBlockCoverage":true},{"functionName":"t.getScriptNameOrSourceURL","ranges":[{"startOffset":60242,"endOffset":60269,"count":344}],"isBlockCoverage":true},{"functionName":"t.getEvalOrigin","ranges":[{"startOffset":60351,"endOffset":60371,"count":0}],"isBlockCoverage":false},{"functionName":"Sc","ranges":[{"startOffset":60375,"endOffset":60652,"count":35},{"startOffset":60394,"endOffset":60409,"count":0},{"startOffset":60426,"endOffset":60435,"count":0},{"startOffset":60529,"endOffset":60588,"count":344}],"isBlockCoverage":true}]},{"scriptId":"254","url":"file:///home/invisible/projects/url-redirector/node_modules/playwright/lib/transform/compilationCache.js","functions":[{"functionName":"retrieveSourceMap","ranges":[{"startOffset":3380,"endOffset":3711,"count":1},{"startOffset":3463,"endOffset":3705,"count":0}],"isBlockCoverage":true},{"functionName":"belongsToNodeModules","ranges":[{"startOffset":9776,"endOffset":10055,"count":1},{"startOffset":9919,"endOffset":10019,"count":0},{"startOffset":10025,"endOffset":10054,"count":0}],"isBlockCoverage":true}]},{"scriptId":"255","url":"file:///home/invisible/projects/url-redirector/node_modules/playwright/lib/common/globals.js","functions":[{"functionName":"get","ranges":[{"startOffset":597,"endOffset":612,"count":1}],"isBlockCoverage":true},{"functionName":"setCurrentTestInfo","ranges":[{"startOffset":1021,"endOffset":1045,"count":1}],"isBlockCoverage":true},{"functionName":"setCurrentTestInfo","ranges":[{"startOffset":1247,"endOffset":1323,"count":1}],"isBlockCoverage":true}]},{"scriptId":"261","url":"file:///home/invisible/projects/url-redirector/node_modules/playwright/lib/worker/fixtureRunner.js","functions":[{"functionName":"useFunc","ranges":[{"startOffset":3307,"endOffset":3604,"count":0},{"startOffset":3598,"endOffset":3603,"count":29}],"isBlockCoverage":true},{"functionName":"","ranges":[{"startOffset":3872,"endOffset":4264,"count":0},{"startOffset":3956,"endOffset":4005,"count":30}],"isBlockCoverage":true},{"functionName":"teardown","ranges":[{"startOffset":4301,"endOffset":4894,"count":35},{"startOffset":4692,"endOffset":4728,"count":0},{"startOffset":4743,"endOffset":4890,"count":36},{"startOffset":4797,"endOffset":4822,"count":57}],"isBlockCoverage":true},{"functionName":"run","ranges":[{"startOffset":4526,"endOffset":4605,"count":35}],"isBlockCoverage":true},{"functionName":"","ranges":[{"startOffset":4574,"endOffset":4604,"count":35}],"isBlockCoverage":true},{"functionName":"_teardownInternal","ranges":[{"startOffset":4897,"endOffset":5313,"count":35},{"startOffset":4983,"endOffset":4990,"count":6},{"startOffset":4990,"endOffset":5024,"count":29},{"startOffset":5024,"endOffset":5153,"count":0},{"startOffset":5153,"endOffset":5309,"count":29},{"startOffset":5303,"endOffset":5309,"count":30}],"isBlockCoverage":true},{"functionName":"_collectFixturesInTeardownOrder","ranges":[{"startOffset":5316,"endOffset":5558,"count":20},{"startOffset":5417,"endOffset":5424,"count":6},{"startOffset":5424,"endOffset":5471,"count":14},{"startOffset":5471,"endOffset":5529,"count":8},{"startOffset":5529,"endOffset":5557,"count":14}],"isBlockCoverage":true},{"functionName":"teardownScope","ranges":[{"startOffset":6510,"endOffset":7091,"count":2},{"startOffset":6722,"endOffset":6780,"count":12},{"startOffset":6838,"endOffset":6983,"count":35},{"startOffset":6903,"endOffset":6912,"count":36},{"startOffset":6912,"endOffset":6977,"count":0},{"startOffset":6983,"endOffset":7016,"count":3},{"startOffset":7043,"endOffset":7070,"count":3},{"startOffset":7070,"endOffset":7087,"count":0}],"isBlockCoverage":true}]},{"scriptId":"263","url":"file:///home/invisible/projects/url-redirector/node_modules/playwright/lib/worker/testInfo.js","functions":[{"functionName":"get","ranges":[{"startOffset":669,"endOffset":684,"count":1}],"isBlockCoverage":true},{"functionName":"TestInfoImpl","ranges":[{"startOffset":1506,"endOffset":1524,"count":1}],"isBlockCoverage":true},{"functionName":"TestInfoImpl","ranges":[{"startOffset":2066,"endOffset":6340,"count":1},{"startOffset":2816,"endOffset":2820,"count":0},{"startOffset":3091,"endOffset":3105,"count":0},{"startOffset":3586,"endOffset":3593,"count":0},{"startOffset":3626,"endOffset":3637,"count":0},{"startOffset":3667,"endOffset":3677,"count":0},{"startOffset":3710,"endOffset":3720,"count":0},{"startOffset":3754,"endOffset":3764,"count":0},{"startOffset":3798,"endOffset":3804,"count":0},{"startOffset":3830,"endOffset":3834,"count":0},{"startOffset":3885,"endOffset":3901,"count":0},{"startOffset":4062,"endOffset":4083,"count":0}],"isBlockCoverage":true},{"functionName":"","ranges":[{"startOffset":3839,"endOffset":3852,"count":0}],"isBlockCoverage":true},{"functionName":"","ranges":[{"startOffset":4106,"endOffset":5062,"count":1},{"startOffset":4377,"endOffset":4402,"count":0},{"startOffset":4736,"endOffset":4817,"count":0},{"startOffset":4848,"endOffset":4887,"count":0},{"startOffset":4928,"endOffset":4978,"count":0}],"isBlockCoverage":true},{"functionName":"","ranges":[{"startOffset":5091,"endOffset":5312,"count":1}],"isBlockCoverage":true},{"functionName":"attachmentsPush","ranges":[{"startOffset":5419,"endOffset":5572,"count":0}],"isBlockCoverage":false},{"functionName":"","ranges":[{"startOffset":5890,"endOffset":5951,"count":0}],"isBlockCoverage":false},{"functionName":"","ranges":[{"startOffset":6018,"endOffset":6080,"count":0}],"isBlockCoverage":false},{"functionName":"","ranges":[{"startOffset":6146,"endOffset":6207,"count":0}],"isBlockCoverage":false},{"functionName":"","ranges":[{"startOffset":6273,"endOffset":6334,"count":0}],"isBlockCoverage":false},{"functionName":"get timeout","ranges":[{"startOffset":6529,"endOffset":6603,"count":1}],"isBlockCoverage":true},{"functionName":"_findLastPredefinedStep","ranges":[{"startOffset":8400,"endOffset":8724,"count":514},{"startOffset":8481,"endOffset":8720,"count":479},{"startOffset":8574,"endOffset":8587,"count":0},{"startOffset":8628,"endOffset":8662,"count":450},{"startOffset":8698,"endOffset":8714,"count":29},{"startOffset":8720,"endOffset":8723,"count":485}],"isBlockCoverage":true},{"functionName":"_addStep","ranges":[{"startOffset":8855,"endOffset":12156,"count":35},{"startOffset":9079,"endOffset":9156,"count":0},{"startOffset":9288,"endOffset":9300,"count":29},{"startOffset":9369,"endOffset":9463,"count":0},{"startOffset":9488,"endOffset":9507,"count":33},{"startOffset":9580,"endOffset":9587,"count":29},{"startOffset":9752,"endOffset":9758,"count":29},{"startOffset":11366,"endOffset":11384,"count":29},{"startOffset":11385,"endOffset":11398,"count":6},{"startOffset":11489,"endOffset":11793,"count":0},{"startOffset":11829,"endOffset":12135,"count":2},{"startOffset":11923,"endOffset":11931,"count":0},{"startOffset":12088,"endOffset":12092,"count":0}],"isBlockCoverage":true},{"functionName":"complete","ranges":[{"startOffset":9777,"endOffset":11320,"count":37},{"startOffset":9831,"endOffset":9838,"count":0},{"startOffset":9904,"endOffset":10287,"count":0},{"startOffset":10361,"endOffset":10582,"count":30},{"startOffset":10395,"endOffset":10434,"count":0},{"startOffset":10436,"endOffset":10570,"count":0},{"startOffset":10618,"endOffset":10938,"count":2},{"startOffset":10978,"endOffset":11312,"count":4},{"startOffset":11023,"endOffset":11097,"count":0}],"isBlockCoverage":true},{"functionName":"","ranges":[{"startOffset":11165,"endOffset":11191,"count":0}],"isBlockCoverage":false},{"functionName":"_runAsStep","ranges":[{"startOffset":12905,"endOffset":13115,"count":35},{"startOffset":13007,"endOffset":13039,"count":37},{"startOffset":13039,"endOffset":13111,"count":0}],"isBlockCoverage":true},{"functionName":"_runWithTimeout","ranges":[{"startOffset":13118,"endOffset":13739,"count":38},{"startOffset":13544,"endOffset":13551,"count":39},{"startOffset":13551,"endOffset":13735,"count":0}],"isBlockCoverage":true},{"functionName":"","ranges":[{"startOffset":13222,"endOffset":13542,"count":38},{"startOffset":13271,"endOffset":13282,"count":39},{"startOffset":13282,"endOffset":13534,"count":0}],"isBlockCoverage":true},{"functionName":"_isFailure","ranges":[{"startOffset":13742,"endOffset":13837,"count":3}],"isBlockCoverage":true},{"functionName":"TestStepInfoImpl","ranges":[{"startOffset":21326,"endOffset":21825,"count":35}],"isBlockCoverage":true},{"functionName":"","ranges":[{"startOffset":21585,"endOffset":21819,"count":0}],"isBlockCoverage":false}]},{"scriptId":"264","url":"file:///home/invisible/projects/url-redirector/node_modules/playwright/lib/worker/timeoutManager.js","functions":[{"functionName":"get","ranges":[{"startOffset":597,"endOffset":612,"count":1}],"isBlockCoverage":true},{"functionName":"TimeoutManager","ranges":[{"startOffset":885,"endOffset":905,"count":1}],"isBlockCoverage":true},{"functionName":"TimeoutManager","ranges":[{"startOffset":1262,"endOffset":1371,"count":1}],"isBlockCoverage":true},{"functionName":"isTimeExhaustedFor","ranges":[{"startOffset":1627,"endOffset":1805,"count":35},{"startOffset":1698,"endOffset":1714,"count":34},{"startOffset":1715,"endOffset":1735,"count":6}],"isBlockCoverage":true},{"functionName":"withRunnable","ranges":[{"startOffset":1808,"endOffset":3056,"count":38},{"startOffset":1872,"endOffset":1926,"count":0},{"startOffset":2009,"endOffset":2015,"count":35},{"startOffset":2016,"endOffset":2032,"count":37},{"startOffset":2033,"endOffset":2053,"count":8},{"startOffset":2292,"endOffset":2599,"count":0},{"startOffset":2731,"endOffset":3052,"count":39},{"startOffset":2993,"endOffset":3046,"count":0}],"isBlockCoverage":true},{"functionName":"_updateTimeout","ranges":[{"startOffset":3059,"endOffset":3672,"count":38},{"startOffset":3114,"endOffset":3142,"count":0},{"startOffset":3226,"endOffset":3286,"count":0},{"startOffset":3479,"endOffset":3544,"count":0}],"isBlockCoverage":true},{"functionName":"","ranges":[{"startOffset":3587,"endOffset":3657,"count":0}],"isBlockCoverage":false},{"functionName":"defaultSlot","ranges":[{"startOffset":3675,"endOffset":3724,"count":2}],"isBlockCoverage":true}]},{"scriptId":"265","url":"file:///home/invisible/projects/url-redirector/node_modules/playwright/lib/worker/testTracing.js","functions":[{"functionName":"get","ranges":[{"startOffset":669,"endOffset":684,"count":1}],"isBlockCoverage":true},{"functionName":"TestTracing","ranges":[{"startOffset":1473,"endOffset":1490,"count":1}],"isBlockCoverage":true},{"functionName":"TestTracing","ranges":[{"startOffset":1943,"endOffset":2683,"count":1}],"isBlockCoverage":true},{"functionName":"_shouldAbandonTrace","ranges":[{"startOffset":5436,"endOffset":5710,"count":1},{"startOffset":5490,"endOffset":5502,"count":0},{"startOffset":5653,"endOffset":5704,"count":0}],"isBlockCoverage":true},{"functionName":"stopIfNeeded","ranges":[{"startOffset":5713,"endOffset":8350,"count":1},{"startOffset":5766,"endOffset":5773,"count":0},{"startOffset":5817,"endOffset":5821,"count":0},{"startOffset":5862,"endOffset":5874,"count":0},{"startOffset":5973,"endOffset":6044,"count":0},{"startOffset":6064,"endOffset":6157,"count":0},{"startOffset":6159,"endOffset":6324,"count":0},{"startOffset":6326,"endOffset":8349,"count":0}],"isBlockCoverage":true},{"functionName":"","ranges":[{"startOffset":6025,"endOffset":6042,"count":0}],"isBlockCoverage":false},{"functionName":"","ranges":[{"startOffset":6696,"endOffset":6842,"count":0}],"isBlockCoverage":false},{"functionName":"","ranges":[{"startOffset":6850,"endOffset":6867,"count":0}],"isBlockCoverage":false},{"functionName":"","ranges":[{"startOffset":6978,"endOffset":7003,"count":0}],"isBlockCoverage":false},{"functionName":"","ranges":[{"startOffset":7209,"endOffset":7221,"count":0}],"isBlockCoverage":false},{"functionName":"","ranges":[{"startOffset":7809,"endOffset":7833,"count":0}],"isBlockCoverage":false},{"functionName":"","ranges":[{"startOffset":7927,"endOffset":8112,"count":0}],"isBlockCoverage":false},{"functionName":"appendBeforeActionForStep","ranges":[{"startOffset":9101,"endOffset":9609,"count":2}],"isBlockCoverage":true},{"functionName":"","ranges":[{"startOffset":9490,"endOffset":9539,"count":0}],"isBlockCoverage":true},{"functionName":"appendAfterActionForStep","ranges":[{"startOffset":9612,"endOffset":9895,"count":4}],"isBlockCoverage":true},{"functionName":"_appendTraceEvent","ranges":[{"startOffset":9898,"endOffset":10095,"count":7},{"startOffset":9995,"endOffset":10091,"count":0}],"isBlockCoverage":true},{"functionName":"serializeAttachments","ranges":[{"startOffset":10098,"endOffset":10404,"count":4},{"startOffset":10193,"endOffset":10403,"count":0}],"isBlockCoverage":true},{"functionName":"","ranges":[{"startOffset":10222,"endOffset":10247,"count":0}],"isBlockCoverage":false},{"functionName":"","ranges":[{"startOffset":10253,"endOffset":10400,"count":0}],"isBlockCoverage":false}]},{"scriptId":"472","url":"file:///home/invisible/projects/url-redirector/node_modules/playwright-core/lib/client/clientInstrumentation.js","functions":[{"functionName":"get","ranges":[{"startOffset":1093,"endOffset":1862,"count":1},{"startOffset":1154,"endOffset":1171,"count":0},{"startOffset":1214,"endOffset":1260,"count":0},{"startOffset":1376,"endOffset":1861,"count":0}],"isBlockCoverage":true},{"functionName":"","ranges":[{"startOffset":1221,"endOffset":1259,"count":0}],"isBlockCoverage":true},{"functionName":"","ranges":[{"startOffset":1313,"endOffset":1375,"count":1}],"isBlockCoverage":true},{"functionName":"","ranges":[{"startOffset":1433,"endOffset":1476,"count":0}],"isBlockCoverage":false},{"functionName":"","ranges":[{"startOffset":1529,"endOffset":1652,"count":0}],"isBlockCoverage":false},{"functionName":"","ranges":[{"startOffset":1712,"endOffset":1823,"count":0}],"isBlockCoverage":false}]},{"scriptId":"476","url":"file:///home/invisible/projects/url-redirector/node_modules/playwright-core/lib/client/playwright.js","functions":[{"functionName":"_browserTypes","ranges":[{"startOffset":2350,"endOffset":2426,"count":1}],"isBlockCoverage":true},{"functionName":"_allContexts","ranges":[{"startOffset":2634,"endOffset":2726,"count":1}],"isBlockCoverage":true},{"functionName":"","ranges":[{"startOffset":2691,"endOffset":2720,"count":3}],"isBlockCoverage":true}]},{"scriptId":"509","url":"node:internal/source_map/source_map_cache_map","functions":[{"functionName":"get size","ranges":[{"startOffset":2979,"endOffset":3032,"count":1}],"isBlockCoverage":true},{"functionName":"","ranges":[{"startOffset":3036,"endOffset":3562,"count":1}],"isBlockCoverage":true},{"functionName":"next","ranges":[{"startOffset":3127,"endOffset":3481,"count":8},{"startOffset":3196,"endOffset":3210,"count":1},{"startOffset":3210,"endOffset":3342,"count":7},{"startOffset":3342,"endOffset":3356,"count":0},{"startOffset":3356,"endOffset":3480,"count":7}],"isBlockCoverage":true},{"functionName":"","ranges":[{"startOffset":3503,"endOffset":3538,"count":0}],"isBlockCoverage":false}]},{"scriptId":"512","url":"file:///home/invisible/projects/url-redirector/node_modules/playwright/lib/index.js","functions":[{"functionName":"playwrightFixtures.playwright.scope","ranges":[{"startOffset":3117,"endOffset":3184,"count":0},{"startOffset":3180,"endOffset":3183,"count":1}],"isBlockCoverage":true},{"functionName":"playwrightFixtures._browserOptions.scope","ranges":[{"startOffset":3925,"endOffset":4358,"count":0},{"startOffset":4307,"endOffset":4357,"count":1}],"isBlockCoverage":true},{"functionName":"playwrightFixtures.baseURL.option","ranges":[{"startOffset":7940,"endOffset":8017,"count":0},{"startOffset":8013,"endOffset":8016,"count":1}],"isBlockCoverage":true},{"functionName":"playwrightFixtures._combinedContextOptions.box","ranges":[{"startOffset":8255,"endOffset":10429,"count":0},{"startOffset":10425,"endOffset":10428,"count":1}],"isBlockCoverage":true},{"functionName":"playwrightFixtures._setupContextOptions.auto","ranges":[{"startOffset":10472,"endOffset":11195,"count":0},{"startOffset":11037,"endOffset":11194,"count":1}],"isBlockCoverage":true},{"functionName":"playwrightFixtures._setupArtifacts.auto","ranges":[{"startOffset":11293,"endOffset":14400,"count":0},{"startOffset":14296,"endOffset":14399,"count":1}],"isBlockCoverage":true},{"functionName":"shouldCaptureUponFinish","ranges":[{"startOffset":22710,"endOffset":22935,"count":2},{"startOffset":22872,"endOffset":22901,"count":0},{"startOffset":22902,"endOffset":22930,"count":0}],"isBlockCoverage":true},{"functionName":"maybeCapture","ranges":[{"startOffset":22938,"endOffset":23138,"count":1},{"startOffset":23015,"endOffset":23137,"count":0}],"isBlockCoverage":true},{"functionName":"","ranges":[{"startOffset":23090,"endOffset":23131,"count":0}],"isBlockCoverage":false},{"functionName":"persistTemporary","ranges":[{"startOffset":23141,"endOffset":23483,"count":1},{"startOffset":23208,"endOffset":23479,"count":0}],"isBlockCoverage":true},{"functionName":"","ranges":[{"startOffset":23254,"endOffset":23470,"count":0}],"isBlockCoverage":false},{"functionName":"get testInfo","ranges":[{"startOffset":24778,"endOffset":24844,"count":2}],"isBlockCoverage":true},{"functionName":"didFinishTestFunction","ranges":[{"startOffset":26993,"endOffset":27079,"count":1}],"isBlockCoverage":true},{"functionName":"didFinishTest","ranges":[{"startOffset":27082,"endOffset":28274,"count":1},{"startOffset":27661,"endOffset":27699,"count":0},{"startOffset":27727,"endOffset":27762,"count":0},{"startOffset":27763,"endOffset":27833,"count":0},{"startOffset":27835,"endOffset":28270,"count":0}],"isBlockCoverage":true},{"functionName":"","ranges":[{"startOffset":27331,"endOffset":27417,"count":0}],"isBlockCoverage":false},{"functionName":"","ranges":[{"startOffset":27450,"endOffset":27537,"count":0}],"isBlockCoverage":false},{"functionName":"","ranges":[{"startOffset":27799,"endOffset":27832,"count":0}],"isBlockCoverage":false}]},{"scriptId":"713","url":"file:///home/invisible/projects/url-redirector/node_modules/graceful-fs/polyfills.js","functions":[{"functionName":"process.cwd","ranges":[{"startOffset":163,"endOffset":234,"count":2},{"startOffset":192,"endOffset":219,"count":0}],"isBlockCoverage":true}]}],"timestamp":228151.147537,"source-map-cache":{"file:///home/invisible/projects/url-redirector/playwright.config.ts":{"lineLengths":[13,0,46,13,3,25,40,58,15,30,37,22,31,34,13,47,25,47,43,15,20,39,15,17,23,36,15,36,57,8,29,58,61,62,90,28,60,8,73,67,5,15,12,12,43,14,17,4,33,8,31,31,34,20,129,5,3,84,3,5192],"data":{"version":3,"names":["_test","require","_default","exports","default","defineConfig","testDir","testMatch","testIgnore","fullyParallel","forbidOnly","process","env","CI","retries","reporter","name","outputFile","open","logging","coverage","lcov","reports","entryFilter","entry","url","includes","isProjectFile","endsWith","sourceFilter","sourcePath","search","outputFolder","outputDir","use","trace","video","screenshot","launchOptions"],"sources":["file:///home/invisible/projects/url-redirector/playwright.config.ts"],"sourcesContent":["import { defineConfig } from \"@playwright/test\";\n\nexport default defineConfig({\n  testDir: \".\",\n  testMatch: [\"**/*.spec.ts\"],\n  testIgnore: [\"**/node_modules/**\"],\n  fullyParallel: true,\n  forbidOnly: !!process.env.CI,\n  retries: process.env.CI ? 2 : 0,\n  reporter: [ // https://playwright.dev/docs/test-reporters\n    [\n      \"monocart-reporter\",\n      {\n        name: \"URL Redirector E2E Coverage Report\",\n        outputFile: \"test/coverage/index.html\",\n        open: true,\n        logging: \"warn\", // \"debug\", \"info\", \"warn\", \"error\"\n        coverage: {\n          lcov: true,\n          reports: [\n            ['v8'],              // generates JSON format files\n            ['html'],             // generates HTML report files\n            ['console-details'], // shows CLI table with summary\n          ],\n          entryFilter: (entry: any) => {\n            // Only accept files that are part of YOUR project\n            if (entry.url.includes('node_modules')) return false;\n            // Only include files that are likely your source code\n            const isProjectFile = entry.url.includes('/dist/') || entry.url.includes('/src/')\n            // Exclude CSS files\n            return isProjectFile && !entry.url.endsWith('.css');\n          },\n          // Keep source filter to ensure we map back to TS files if possible\n          sourceFilter: (sourcePath: string) => sourcePath.search(/src\\//) !== -1,\n        },\n      },\n    ],\n    [\"list\"], // compact\n    [\"html\", { outputFolder: \"test/playwright-report\", open: true }], // artifacts\n  ],\n  outputDir: \"test/test-results\",\n  use: {\n    trace: \"retain-on-failure\",\n    video: \"retain-on-failure\",\n    screenshot: \"only-on-failure\",\n    launchOptions: {\n      // slowMo: 100, // Optionally slow down the test execution in the browser. Use with workers: 1 to watch the test execution.\n    },\n  },\n  // workers: 1, // Use 1 worker to run tests serially and watch the test execution.\n});"],"mappings":";;;;;;AAAA,IAAAA,KAAA,GAAAC,OAAA;AAAgD,IAAAC,QAAA,GAAAC,OAAA,CAAAC,OAAA,GAEjC,IAAAC,kBAAY,EAAC;EAC1BC,OAAO,EAAE,GAAG;EACZC,SAAS,EAAE,CAAC,cAAc,CAAC;EAC3BC,UAAU,EAAE,CAAC,oBAAoB,CAAC;EAClCC,aAAa,EAAE,IAAI;EACnBC,UAAU,EAAE,CAAC,CAACC,OAAO,CAACC,GAAG,CAACC,EAAE;EAC5BC,OAAO,EAAEH,OAAO,CAACC,GAAG,CAACC,EAAE,GAAG,CAAC,GAAG,CAAC;EAC/BE,QAAQ,EAAE;EAAE;EACV,CACE,mBAAmB,EACnB;IACEC,IAAI,EAAE,oCAAoC;IAC1CC,UAAU,EAAE,0BAA0B;IACtCC,IAAI,EAAE,IAAI;IACVC,OAAO,EAAE,MAAM;IAAE;IACjBC,QAAQ,EAAE;MACRC,IAAI,EAAE,IAAI;MACVC,OAAO,EAAE,CACP,CAAC,IAAI,CAAC;MAAe;MACrB,CAAC,MAAM,CAAC;MAAc;MACtB,CAAC,iBAAiB,CAAC,CAAE;MAAA,CACtB;MACDC,WAAW,EAAGC,KAAU,IAAK;QAC3B;QACA,IAAIA,KAAK,CAACC,GAAG,CAACC,QAAQ,CAAC,cAAc,CAAC,EAAE,OAAO,KAAK;QACpD;QACA,MAAMC,aAAa,GAAGH,KAAK,CAACC,GAAG,CAACC,QAAQ,CAAC,QAAQ,CAAC,IAAIF,KAAK,CAACC,GAAG,CAACC,QAAQ,CAAC,OAAO,CAAC;QACjF;QACA,OAAOC,aAAa,IAAI,CAACH,KAAK,CAACC,GAAG,CAACG,QAAQ,CAAC,MAAM,CAAC;MACrD,CAAC;MACD;MACAC,YAAY,EAAGC,UAAkB,IAAKA,UAAU,CAACC,MAAM,CAAC,OAAO,CAAC,KAAK,CAAC;IACxE;EACF,CAAC,CACF,EACD,CAAC,MAAM,CAAC;EAAE;EACV,CAAC,MAAM,EAAE;IAAEC,YAAY,EAAE,wBAAwB;IAAEd,IAAI,EAAE;EAAK,CAAC,CAAC,CAAE;EAAA,CACnE;EACDe,SAAS,EAAE,mBAAmB;EAC9BC,GAAG,EAAE;IACHC,KAAK,EAAE,mBAAmB;IAC1BC,KAAK,EAAE,mBAAmB;IAC1BC,UAAU,EAAE,iBAAiB;IAC7BC,aAAa,EAAE;MACb;IAAA;EAEJ;EACA;AACF,CAAC,CAAC","ignoreList":[],"sourceRoot":""},"url":null},"file:///home/invisible/projects/url-redirector/test/scripts/build.spec.ts":{"lineLengths":[13,0,53,44,54,19,13,14,15,16,16,17,18,28,24,42,14,15,16,26,22,53,55,57,38,33,29,6,14,47,27,12,9,31,29,45,33,29,25,50,14,20,39,13,13,9,18,8,41,27,30,15,17,11,8,34,27,21,14,14,11,7,6,5,80,29,13,31,19,21,23,24,7,7,0,17,98,90,0,21,95,0,26,95,133,87,0,33,108,56,98,81,5,73,26,36,6,0,53,38,17,28,22,40,6,9,31,15,33,21,23,25,26,9,9,17,69,15,34,5,90,51,5,3,11724],"data":{"version":3,"names":["_coverageFixture","require","_build","test","describe","mockExecSync","mockFs","mockLog","mockWarn","mockError","logs","warns","errors","executedCommands","fsOperations","beforeEach","args","push","join","cmd","options","Buffer","from","emptyDirSync","path","op","existsSync","readFileSync","endsWith","JSON","stringify","version","background","service_worker","icons","writeFileSync","content","copy","src","dest","build","deps","execSync","fs","log","warn","error","expect","some","l","includes","toBe","writeOp","find","writtenManifest","parse","Error","originalExit","process","exit","exitCode","code","e","message"],"sources":["file:///home/invisible/projects/url-redirector/test/scripts/build.spec.ts"],"sourcesContent":["import { test, expect } from './coverage-fixture';\nimport { build } from '../../scripts/build';\nimport path from 'path';\n\ntest.describe('Build Script', () => {\n    let mockExecSync: any;\n    let mockFs: any;\n    let mockLog: any;\n    let mockWarn: any;\n    let mockError: any;\n    let logs: string[] = [];\n    let warns: string[] = [];\n    let errors: string[] = [];\n    let executedCommands: string[] = [];\n    let fsOperations: any[] = [];\n\n    test.beforeEach(() => {\n        logs = [];\n        warns = [];\n        errors = [];\n        executedCommands = [];\n        fsOperations = [];\n\n        mockLog = (...args: any[]) => logs.push(args.join(' '));\n        mockWarn = (...args: any[]) => warns.push(args.join(' '));\n        mockError = (...args: any[]) => errors.push(args.join(' '));\n\n        mockExecSync = (cmd: string, options: any) => {\n            executedCommands.push(cmd);\n            return Buffer.from('');\n        };\n\n        mockFs = {\n            emptyDirSync: (path: string) => fsOperations.push({ op: 'emptyDirSync', path }),\n            existsSync: (path: string) => true,\n            readFileSync: (path: string) => {\n                if (path.endsWith('manifest.json')) {\n                    return JSON.stringify({\n                        version: '1.0.0',\n                        background: { service_worker: 'dist/background.js' },\n                        icons: { \"16\": \"assets/icon16.png\" }\n                    });\n                }\n                return '';\n            },\n            writeFileSync: (path: string, content: string) => {\n                fsOperations.push({ op: 'writeFileSync', path, content });\n            },\n            copy: async (src: string, dest: string) => {\n                fsOperations.push({ op: 'copy', src, dest });\n            }\n        };\n    });\n\n    test('should run build process correctly', async () => {\n        await build({\n            deps: {\n                execSync: mockExecSync,\n                fs: mockFs,\n                log: mockLog,\n                warn: mockWarn,\n                error: mockError\n            }\n        });\n\n        // Check logs\n        expect(logs.some(l => l.includes('Starting build process'))).toBe(true);\n        expect(logs.some(l => l.includes('Build complete'))).toBe(true);\n\n        // Check commands\n        expect(executedCommands.some(cmd => cmd.includes('tsc'))).toBe(true);\n\n        // Check FS operations\n        expect(fsOperations.some(op => op.op === 'emptyDirSync')).toBe(true);\n        expect(fsOperations.some(op => op.op === 'writeFileSync' && op.path.endsWith('manifest.json'))).toBe(true);\n        expect(fsOperations.some(op => op.op === 'copy')).toBe(true);\n\n        // Verify manifest adjustment\n        const writeOp = fsOperations.find(op => op.op === 'writeFileSync' && op.path.endsWith('manifest.json'));\n        const writtenManifest = JSON.parse(writeOp.content);\n        expect(writtenManifest.background.service_worker).toBe('background.js');\n        expect(writtenManifest.icons[\"16\"]).toBe('icon16.png');\n    });\n\n    test('should handle build failure', async () => {\n        mockExecSync = () => { throw new Error('TSC Failed'); };\n\n        // Mock process.exit to prevent test from exiting\n        const originalExit = process.exit;\n        let exitCode: number | undefined;\n        process.exit = ((code?: number) => {\n            exitCode = code;\n            throw new Error('Process Exited');\n        }) as any;\n\n        try {\n            await build({\n                deps: {\n                    execSync: mockExecSync,\n                    fs: mockFs,\n                    log: mockLog,\n                    warn: mockWarn,\n                    error: mockError\n                }\n            });\n        } catch (e: any) {\n            expect(e.message).toBe('Process Exited');\n        } finally {\n            process.exit = originalExit;\n        }\n\n        expect(errors.some(e => e.includes('Build failed'))).toBe(true);\n        expect(exitCode).toBe(1);\n    });\n});\n"],"mappings":"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","ignoreList":[],"sourceRoot":""},"url":null},"file:///home/invisible/projects/url-redirector/test/scripts/coverage-fixture.ts":{"lineLengths":[13,0,46,13,3,39,40,53,47,85,47,54,16,9,64,49,21,33,154,34,66,54,77,16,64,9,7,17,61,5,6,15,17,4,3,50,3976],"data":{"version":3,"names":["_test","require","_monocartReporter","_v","_interopRequireDefault","e","__esModule","default","test","exports","base","extend","autoCollectCoverage","use","testInfo","coverage","v8","takeCoverage","filtered","filter","entry","url","includes","length","console","log","addCoverageReport","warn","auto","scope","expect"],"sources":["file:///home/invisible/projects/url-redirector/test/scripts/coverage-fixture.ts"],"sourcesContent":["import { test as base } from '@playwright/test';\nimport { addCoverageReport } from 'monocart-reporter';\nimport v8 from 'v8';\n\nexport const test = base.extend<{ autoCollectCoverage: void }>({\n    autoCollectCoverage: [async ({ }, use, testInfo) => {\n        await use();\n\n        try {\n            // @ts-ignore - takeCoverage exists in newer Node versions\n            const coverage = (v8 as any).takeCoverage();\n\n            if (coverage) {\n                // Filter for our scripts\n                const filtered = coverage.filter((entry: any) =>\n                    entry.url.includes('/scripts/') &&\n                    !entry.url.includes('node_modules') &&\n                    !entry.url.includes('test/')\n                );\n\n                if (filtered.length > 0) {\n                    console.log('Found coverage entries:', filtered.length);\n                    console.log('Sample URL:', filtered[0].url);\n                    await addCoverageReport(filtered, testInfo);\n                } else {\n                    console.log('No coverage entries found for scripts/');\n                }\n            }\n        } catch (e) {\n            console.warn('Failed to collect Node.js coverage:', e);\n        }\n    }, { auto: true, scope: 'test' }]\n});\n\nexport const expect = base.expect;\n"],"mappings":";;;;;;AAAA,IAAAA,KAAA,GAAAC,OAAA;AACA,IAAAC,iBAAA,GAAAD,OAAA;AACA,IAAAE,EAAA,GAAAC,sBAAA,CAAAH,OAAA;AAAoB,SAAAG,uBAAAC,CAAA,WAAAA,CAAA,IAAAA,CAAA,CAAAC,UAAA,GAAAD,CAAA,KAAAE,OAAA,EAAAF,CAAA;AAEb,MAAMG,IAAI,GAAAC,OAAA,CAAAD,IAAA,GAAGE,UAAI,CAACC,MAAM,CAAgC;EAC3DC,mBAAmB,EAAE,CAAC,OAAO,CAAE,CAAC,EAAEC,GAAG,EAAEC,QAAQ,KAAK;IAChD,MAAMD,GAAG,CAAC,CAAC;IAEX,IAAI;MACA;MACA,MAAME,QAAQ,GAAIC,UAAE,CAASC,YAAY,CAAC,CAAC;MAE3C,IAAIF,QAAQ,EAAE;QACV;QACA,MAAMG,QAAQ,GAAGH,QAAQ,CAACI,MAAM,CAAEC,KAAU,IACxCA,KAAK,CAACC,GAAG,CAACC,QAAQ,CAAC,WAAW,CAAC,IAC/B,CAACF,KAAK,CAACC,GAAG,CAACC,QAAQ,CAAC,cAAc,CAAC,IACnC,CAACF,KAAK,CAACC,GAAG,CAACC,QAAQ,CAAC,OAAO,CAC/B,CAAC;QAED,IAAIJ,QAAQ,CAACK,MAAM,GAAG,CAAC,EAAE;UACrBC,OAAO,CAACC,GAAG,CAAC,yBAAyB,EAAEP,QAAQ,CAACK,MAAM,CAAC;UACvDC,OAAO,CAACC,GAAG,CAAC,aAAa,EAAEP,QAAQ,CAAC,CAAC,CAAC,CAACG,GAAG,CAAC;UAC3C,MAAM,IAAAK,mCAAiB,EAACR,QAAQ,EAAEJ,QAAQ,CAAC;QAC/C,CAAC,MAAM;UACHU,OAAO,CAACC,GAAG,CAAC,wCAAwC,CAAC;QACzD;MACJ;IACJ,CAAC,CAAC,OAAOpB,CAAC,EAAE;MACRmB,OAAO,CAACG,IAAI,CAAC,qCAAqC,EAAEtB,CAAC,CAAC;IAC1D;EACJ,CAAC,EAAE;IAAEuB,IAAI,EAAE,IAAI;IAAEC,KAAK,EAAE;EAAO,CAAC;AACpC,CAAC,CAAC;AAEK,MAAMC,MAAM,GAAArB,OAAA,CAAAqB,MAAA,GAAGpB,UAAI,CAACoB,MAAM","ignoreList":[],"sourceRoot":""},"url":null},"file:///home/invisible/projects/url-redirector/scripts/build.ts":{"lineLengths":[13,0,46,13,3,22,59,52,46,85,55,36,9,15,13,14,60,43,38,41,44,103,7,40,0,30,41,31,0,28,38,78,107,23,18,7,0,28,39,0,42,73,74,43,49,73,51,0,75,70,101,7,0,82,60,68,61,52,5,0,50,60,37,42,32,12,61,5,30,49,17,34,20,3,1,30,37,29,9,14,5,1,8608],"data":{"version":3,"names":["_fsExtra","_interopRequireDefault","require","_path","_child_process","e","__esModule","default","rootDir","path","resolve","__dirname","build","options","customDist","deps","execSync","realExecSync","fsFn","fs","log","console","warn","error","distDir","join","emptyDirSync","stdio","cwd","manifestSrcPath","manifestDestPath","existsSync","manifestContent","readFileSync","manifest","JSON","parse","background","service_worker","replace","manifestStr","stringify","adjustedManifest","writeFileSync","assetsDir","copy","err","process","exit","main","module","args","argv","slice"],"sources":["file:///home/invisible/projects/url-redirector/scripts/build.ts"],"sourcesContent":["import fs from 'fs-extra';\nimport path from 'path';\nimport { execSync as realExecSync } from 'child_process';\n\nconst rootDir = path.resolve(__dirname, '..');\n\nexport interface BuildOptions {\n    customDist?: string;\n    deps?: {\n        execSync?: typeof realExecSync;\n        fs?: typeof fs;\n        log?: typeof console.log;\n        warn?: typeof console.warn;\n        error?: typeof console.error;\n    };\n}\n\nexport async function build(options: BuildOptions = {}) {\n    const { customDist, deps = {} } = options;\n    const execSync = deps.execSync || realExecSync;\n    const fsFn = deps.fs || fs;\n    const log = deps.log || console.log;\n    const warn = deps.warn || console.warn;\n    const error = deps.error || console.error;\n\n    const distDir = customDist ? path.resolve(customDist) : path.join(rootDir, 'dist');\n\n    try {\n        log(' Starting build process...');\n\n        // 1. Clean dist directory\n        log(' Cleaning dist directory...');\n        fsFn.emptyDirSync(distDir);\n\n        // 2. Compile TypeScript\n        log(' Compiling TypeScript...');\n        // Compile TypeScript with explicit ES2020 module output for the extension\n        execSync(\n            `tsc --module ES2020 --rootDir src --outDir \"${distDir}\" --lib ES2020,DOM --sourceMap true`,\n            { stdio: 'inherit', cwd: rootDir }\n        );\n\n        // 3. Copy static assets\n        log(' Copying static assets...');\n\n        // Copy manifest.json with adjustments\n        const manifestSrcPath = path.join(rootDir, 'manifest.json');\n        const manifestDestPath = path.join(distDir, 'manifest.json');\n\n        if (fsFn.existsSync(manifestSrcPath)) {\n            // Read and adjust manifest for dist folder\n            const manifestContent = fsFn.readFileSync(manifestSrcPath, 'utf8');\n            const manifest = JSON.parse(manifestContent);\n\n            // Adjust background script path: dist/background.js -> background.js\n            if (manifest.background && manifest.background.service_worker) {\n                manifest.background.service_worker = manifest.background.service_worker.replace('dist/', '');\n            }\n\n            // Adjust asset paths: assets/... -> ... (since we copy assets to dist root)\n            const manifestStr = JSON.stringify(manifest, null, 2);\n            const adjustedManifest = manifestStr.replace(/assets\\//g, '');\n\n            fsFn.writeFileSync(manifestDestPath, adjustedManifest);\n            log(`    Copied and adjusted manifest.json`);\n        }\n\n        // Copy assets directory contents to dist root\n        const assetsDir = path.join(rootDir, 'assets');\n        if (fsFn.existsSync(assetsDir)) {\n            await fsFn.copy(assetsDir, distDir);\n            log(`    Copied assets`);\n        } else {\n            warn(`     assets directory not found, skipping...`);\n        }\n\n        log(' Build complete!');\n        log(` Extension files are in: ${distDir}`);\n\n    } catch (err: unknown) {\n        error(' Build failed:', err);\n        process.exit(1);\n    }\n}\n\nif (require.main === module) {\n    const args = process.argv.slice(2);\n    const customDist = args[0];\n    build({ customDist });\n}\n"],"mappings":"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","ignoreList":[],"sourceRoot":""},"url":null},"file:///home/invisible/projects/url-redirector/test/scripts/submit-cws.spec.ts":{"lineLengths":[13,0,53,53,63,19,16,14,15,22,13,16,17,28,22,42,14,15,26,20,53,55,38,33,29,6,41,23,12,15,9,14,17,28,37,23,11,30,8,6,35,30,6,14,31,46,30,24,8,65,6,0,20,49,57,57,5,88,37,19,13,31,25,21,23,40,18,7,7,0,17,83,103,101,113,0,21,79,101,0,18,60,5,89,37,20,13,31,25,21,23,40,18,7,7,0,17,87,99,0,21,79,99,92,0,18,71,92,92,93,5,89,30,35,16,20,22,42,10,7,14,17,28,36,10,8,6,66,20,13,31,25,21,23,40,18,7,72,5,3,13456],"data":{"version":3,"names":["_coverageFixture","require","_submitCws","test","describe","mockExecSync","mockFetch","mockLog","mockWarn","mockLoadSecrets","mockFs","logs","warns","executedCommands","fetchCalls","beforeEach","args","push","join","cmd","options","Buffer","from","url","ok","json","access_token","id","text","existsSync","path","createReadStream","readJsonSync","version","process","env","CWS_CLIENT_ID","CWS_CLIENT_SECRET","CWS_REFRESH_TOKEN","submitCws","dryRun","deps","execSync","fetch","log","warn","loadGcpSecrets","fs","expect","some","l","includes","toBe","toContain","length","toBeGreaterThan","c","status","rejects","toThrow"],"sources":["file:///home/invisible/projects/url-redirector/test/scripts/submit-cws.spec.ts"],"sourcesContent":["import { test, expect } from './coverage-fixture';\nimport { submitCws } from '../../scripts/submit-cws';\nimport path from 'path';\n\ntest.describe('CWS Submission Script', () => {\n    let mockExecSync: any;\n    let mockFetch: any;\n    let mockLog: any;\n    let mockWarn: any;\n    let mockLoadSecrets: any;\n    let mockFs: any;\n    let logs: string[] = [];\n    let warns: string[] = [];\n    let executedCommands: string[] = [];\n    let fetchCalls: any[] = [];\n\n    test.beforeEach(() => {\n        logs = [];\n        warns = [];\n        executedCommands = [];\n        fetchCalls = [];\n\n        mockLog = (...args: any[]) => logs.push(args.join(' '));\n        mockWarn = (...args: any[]) => warns.push(args.join(' '));\n\n        mockExecSync = (cmd: string, options: any) => {\n            executedCommands.push(cmd);\n            return Buffer.from('');\n        };\n\n        mockFetch = async (url: string, options: any) => {\n            fetchCalls.push({ url, options });\n            return {\n                ok: true,\n                json: async () => ({ access_token: 'fake_token', id: 'fake_id' }),\n                text: async () => 'ok'\n            };\n        };\n\n        mockLoadSecrets = async () => {\n            // Do nothing, just mock\n        };\n\n        mockFs = {\n            existsSync: (path: string) => true,\n            createReadStream: (path: string) => 'fake_stream',\n            readJsonSync: (path: string) => ({ version: '1.0.0' }),\n            // Add other methods if needed, but these are the ones used\n        };\n\n        // Mock env vars\n        process.env.CWS_CLIENT_ID = 'fake_client_id';\n        process.env.CWS_CLIENT_SECRET = 'fake_client_secret';\n        process.env.CWS_REFRESH_TOKEN = 'fake_refresh_token';\n    });\n\n    test('Dry Run: should not call fetch or git push', async () => {\n        await submitCws({\n            dryRun: true,\n            deps: {\n                execSync: mockExecSync,\n                fetch: mockFetch,\n                log: mockLog,\n                warn: mockWarn,\n                loadGcpSecrets: mockLoadSecrets,\n                fs: mockFs\n            }\n        });\n\n        // Check logs\n        expect(logs.some(l => l.includes('DRY RUN'))).toBe(true);\n        expect(logs.some(l => l.includes('Skipping Upload and Publish'))).toBe(true);\n        expect(logs.some(l => l.includes('Skipping Git Tag and Push'))).toBe(true);\n        expect(logs.some(l => l.includes('Run with --submit to actually publish'))).toBe(true);\n\n        // Check commands\n        expect(executedCommands).toContain('npm run bundle');\n        expect(executedCommands.some(cmd => cmd.includes('git push'))).toBe(false);\n\n        // Check fetch\n        expect(fetchCalls.length).toBe(0);\n    });\n\n    test('Submit Mode: should call fetch and git push', async () => {\n        await submitCws({\n            dryRun: false,\n            deps: {\n                execSync: mockExecSync,\n                fetch: mockFetch,\n                log: mockLog,\n                warn: mockWarn,\n                loadGcpSecrets: mockLoadSecrets,\n                fs: mockFs\n            }\n        });\n\n        // Check logs\n        expect(logs.some(l => l.includes('SUBMIT MODE'))).toBe(true);\n        expect(logs.some(l => l.includes('Authenticating with CWS'))).toBe(true);\n\n        // Check commands\n        expect(executedCommands).toContain('npm run bundle');\n        expect(executedCommands.some(cmd => cmd.includes('git tag'))).toBe(true);\n        expect(executedCommands).toContain('git push && git push --tags');\n\n        // Check fetch\n        expect(fetchCalls.length).toBeGreaterThan(0);\n        expect(fetchCalls.some(c => c.url.includes('oauth2'))).toBe(true);\n        expect(fetchCalls.some(c => c.url.includes('upload'))).toBe(true);\n        expect(fetchCalls.some(c => c.url.includes('publish'))).toBe(true);\n    });\n\n    test('Error Handling: should fail if upload fails', async () => {\n        mockFetch = async (url: string) => {\n            if (url.includes('upload')) {\n                return {\n                    ok: false,\n                    status: 500,\n                    text: async () => 'Upload Error'\n                };\n            }\n            return {\n                ok: true,\n                json: async () => ({ access_token: 'fake_token' })\n            };\n        };\n\n        await expect(submitCws({\n            dryRun: false,\n            deps: {\n                execSync: mockExecSync,\n                fetch: mockFetch,\n                log: mockLog,\n                warn: mockWarn,\n                loadGcpSecrets: mockLoadSecrets,\n                fs: mockFs\n            }\n        })).rejects.toThrow('Failed to upload extension: 500 Upload Error');\n    });\n});\n"],"mappings":"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","ignoreList":[],"sourceRoot":""},"url":null},"file:///home/invisible/projects/url-redirector/scripts/submit-cws.ts":{"lineLengths":[19,13,0,46,13,3,30,59,46,59,52,85,24,64,68,0,21,0,27,78,73,19,14,57,6,31,26,34,34,33,6,5,21,39,78,3,46,1,82,97,51,0,15,45,18,14,47,31,6,17,20,18,5,21,39,78,3,37,14,1,68,99,46,19,14,47,31,5,5,21,39,79,3,37,14,1,0,21,35,9,11,13,14,60,45,38,41,79,43,74,0,20,31,22,46,54,54,76,55,17,74,12,119,5,3,0,24,34,30,20,5,77,34,60,3,0,37,15,53,39,47,54,10,41,95,47,98,46,48,85,48,3,0,22,76,51,35,32,15,51,43,41,10,44,9,38,24,9,17,53,5,40,45,22,7,3,54,1,0,20,30,16,9,41,49,23,25,9,21,49,22,5,7,1,17172],"data":{"version":3,"names":["Object","defineProperty","exports","value","submitCws","_loadDotenvFromGcp","require","_child_process","_fsExtra","_interopRequireDefault","_path","e","__esModule","default","EXTENSION_ID_DEFAULT","PUBLISHER_ID_DEFAULT","getAccessToken","clientId","clientSecret","refreshToken","fetchFn","response","method","headers","body","URLSearchParams","client_id","client_secret","refresh_token","grant_type","ok","text","Error","status","json","access_token","uploadExtension","accessToken","extensionId","zipPath","fsFn","uploadUrl","zipStream","createReadStream","duplex","data","publishExtension","publishUrl","options","dryRun","deps","execSync","realExecSync","fetch","global","log","console","warn","loadSecrets","loadGcpSecrets","fs","CLIENT_ID","process","env","CWS_CLIENT_ID","CLIENT_SECRET","CWS_CLIENT_SECRET","REFRESH_TOKEN","CWS_REFRESH_TOKEN","EXTENSION_ID","CWS_EXTENSION_ID","stdio","path","resolve","__dirname","existsSync","uploadResult","publishResult","manifestPath","manifest","readJsonSync","version","tagName","main","module","args","argv","slice","isSubmit","includes","error","exit"],"sources":["file:///home/invisible/projects/url-redirector/scripts/submit-cws.ts"],"sourcesContent":["#!/usr/bin/env node\n\nimport { loadGcpSecrets } from './load-dotenv-from-gcp';\nimport { execSync as realExecSync } from 'child_process';\nimport fs from 'fs-extra';\nimport path from 'path';\n\n// --- Configuration ---\nconst EXTENSION_ID_DEFAULT = 'jhkoaofpbohfmolalpieheaeppdaminl';\nconst PUBLISHER_ID_DEFAULT = 'c173d09b-31cf-48ff-bd4b-270d57317183';\n\n// --- Interfaces ---\nexport interface SubmitCwsOptions {\n    dryRun: boolean;\n    deps?: {\n        execSync?: typeof realExecSync;\n        fetch?: typeof fetch;\n        log?: typeof console.log;\n        warn?: typeof console.warn;\n        error?: typeof console.error;\n        loadGcpSecrets?: typeof loadGcpSecrets;\n        fs?: typeof fs;\n    };\n}\n\n// --- Helper Functions ---\nasync function getAccessToken(clientId: string, clientSecret: string, refreshToken: string, fetchFn: typeof fetch) {\n    const response = await fetchFn('https://oauth2.googleapis.com/token', {\n        method: 'POST',\n        headers: { 'Content-Type': 'application/x-www-form-urlencoded' },\n        body: new URLSearchParams({\n            client_id: clientId,\n            client_secret: clientSecret,\n            refresh_token: refreshToken,\n            grant_type: 'refresh_token',\n        }),\n    });\n\n    if (!response.ok) {\n        const text = await response.text();\n        throw new Error(`Failed to get access token: ${response.status} ${text}`);\n    }\n    return (await response.json()).access_token;\n}\n\nasync function uploadExtension(accessToken: string, extensionId: string, zipPath: string, fetchFn: typeof fetch, fsFn: typeof fs) {\n    const uploadUrl = `https://www.googleapis.com/upload/chromewebstore/v1.1/items/${extensionId}`;\n    const zipStream = fsFn.createReadStream(zipPath);\n\n    // @ts-ignore\n    const response = await fetchFn(uploadUrl, {\n        method: 'PUT',\n        headers: {\n            'Authorization': `Bearer ${accessToken}`,\n            'x-goog-api-version': '2',\n        },\n        // @ts-ignore\n        body: zipStream,\n        duplex: 'half'\n    });\n\n    if (!response.ok) {\n        const text = await response.text();\n        throw new Error(`Failed to upload extension: ${response.status} ${text}`);\n    }\n\n    const data = await response.json();\n    return data;\n}\n\nasync function publishExtension(accessToken: string, extensionId: string, fetchFn: typeof fetch) {\n    const publishUrl = `https://www.googleapis.com/chromewebstore/v1.1/items/${extensionId}/publish`;\n\n    const response = await fetchFn(publishUrl, {\n        method: 'POST',\n        headers: {\n            'Authorization': `Bearer ${accessToken}`,\n            'x-goog-api-version': '2',\n        },\n    });\n\n    if (!response.ok) {\n        const text = await response.text();\n        throw new Error(`Failed to publish extension: ${response.status} ${text}`);\n    }\n\n    const data = await response.json();\n    return data;\n}\n\n// --- Main Logic ---\nexport async function submitCws(options: SubmitCwsOptions) {\n    const { dryRun, deps = {} } = options;\n    const execSync = deps.execSync || realExecSync;\n    const fetchFn = deps.fetch || global.fetch;\n    const log = deps.log || console.log;\n    const warn = deps.warn || console.warn;\n    const loadSecrets = deps.loadGcpSecrets || loadGcpSecrets;\n    const fsFn = deps.fs || fs;\n\n    log(` CWS Submission Script (${dryRun ? 'DRY RUN' : 'SUBMIT MODE'})`);\n\n    // 1. Load Secrets\n    log(' Loading secrets...');\n    await loadSecrets();\n\n    const CLIENT_ID = process.env.CWS_CLIENT_ID;\n    const CLIENT_SECRET = process.env.CWS_CLIENT_SECRET;\n    const REFRESH_TOKEN = process.env.CWS_REFRESH_TOKEN;\n    const EXTENSION_ID = process.env.CWS_EXTENSION_ID || EXTENSION_ID_DEFAULT;\n\n    if (!CLIENT_ID || !CLIENT_SECRET || !REFRESH_TOKEN) {\n        if (dryRun) {\n            warn(' Missing CWS credentials, but proceeding in DRY RUN mode.');\n        } else {\n            throw new Error('Missing required environment variables (CWS_CLIENT_ID, CWS_CLIENT_SECRET, CWS_REFRESH_TOKEN).');\n        }\n    }\n\n    // 2. Bundle Extension\n    log(' Bundling extension...');\n    execSync('npm run bundle', { stdio: 'inherit' });\n    const zipPath = path.resolve(__dirname, '../build/extension.zip');\n\n    if (!fsFn.existsSync(zipPath)) {\n        throw new Error(`Bundle failed: ${zipPath} not found.`);\n    }\n\n    // 3. Upload & Publish (or Dry Run)\n    if (dryRun) {\n        log(' [DRY RUN] Skipping Upload and Publish.');\n        log(`   Would upload: ${zipPath}`);\n        log(`   To Extension ID: ${EXTENSION_ID}`);\n        log('  Run with --submit to actually publish.');\n    } else {\n        log(' Authenticating with CWS...');\n        const accessToken = await getAccessToken(CLIENT_ID!, CLIENT_SECRET!, REFRESH_TOKEN!, fetchFn);\n\n        log(' Uploading to Chrome Web Store...');\n        const uploadResult = await uploadExtension(accessToken, EXTENSION_ID, zipPath, fetchFn, fsFn);\n        log(' Upload successful:', uploadResult);\n\n        log(' Publishing to Chrome Web Store...');\n        const publishResult = await publishExtension(accessToken, EXTENSION_ID, fetchFn);\n        log(' Publish successful:', publishResult);\n    }\n\n    // 4. Git Tag & Push\n    const manifestPath = path.resolve(__dirname, '../manifest.json');\n    const manifest = fsFn.readJsonSync(manifestPath);\n    const version = manifest.version;\n    const tagName = `v${version}`;\n\n    if (dryRun) {\n        log(` [DRY RUN] Skipping Git Tag and Push.`);\n        log(`   Would create tag: ${tagName}`);\n        log(`   Would push tag: ${tagName}`);\n    } else {\n        log(` Creating git tag: ${tagName}`);\n        try {\n            execSync(`git tag ${tagName}`, { stdio: 'inherit' });\n        } catch (e) {\n            warn(` Tag ${tagName} might already exist.`);\n        }\n\n        log(' Pushing tags to remote...');\n        execSync('git push && git push --tags', { stdio: 'inherit' });\n    }\n\n    log('\\n Submission script finished successfully!');\n}\n\n// --- Execution ---\nif (require.main === module) {\n    (async () => {\n        try {\n            const args = process.argv.slice(2);\n            const isSubmit = args.includes('--submit');\n            await submitCws({ dryRun: !isSubmit });\n        } catch (error) {\n            console.error('\\n Script failed:', error);\n            process.exit(1);\n        }\n    })();\n}\n"],"mappings":"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","ignoreList":[],"sourceRoot":""},"url":null},"file:///home/invisible/projects/url-redirector/scripts/load-dotenv-from-gcp.ts":{"lineLengths":[13,0,46,13,3,40,61,56,85,68,9,13,14,94,38,47,41,30,98,95,87,7,25,56,10,7,228,25,49,5,59,32,36,5,21,19,22,31,95,172,7,107,82,64,92,83,33,13,5,0,92,16,3,1,6676],"data":{"version":3,"names":["_secretManager","require","_dotenv","_interopRequireDefault","e","__esModule","default","loadGcpSecrets","projectId","secretName","options","deps","Client","SecretManagerServiceClient","log","console","errorLog","error","exit","process","client","finalProjectId","env","GOOGLE_CLOUD_PROJECT","finalSecretName","GCP_SECRET_NAME","name","_version$payload","version","accessSecretVersion","secretPayload","payload","data","toString","Error","envConfig","dotenv","parse","k","err","message","includes","code"],"sources":["file:///home/invisible/projects/url-redirector/scripts/load-dotenv-from-gcp.ts"],"sourcesContent":["import { SecretManagerServiceClient } from '@google-cloud/secret-manager';\nimport dotenv from 'dotenv';\n\ninterface SecretManagerError extends Error {\n  code?: number;\n}\n\nexport interface LoadGcpSecretsOptions {\n  deps?: {\n    SecretManagerServiceClient?: typeof SecretManagerServiceClient;\n    log?: typeof console.log;\n    error?: typeof console.error;\n    exit?: typeof process.exit;\n  }\n}\n\nexport async function loadGcpSecrets(projectId?: string, secretName?: string, options: LoadGcpSecretsOptions = {}): Promise<dotenv.DotenvParseOutput | undefined> {\n  const { deps = {} } = options;\n  const Client = deps.SecretManagerServiceClient || SecretManagerServiceClient;\n  const log = deps.log || console.log;\n  const errorLog = deps.error || console.error;\n  const exit = deps.exit || process.exit;\n\n  const client = new Client();\n\n  const finalProjectId = projectId || process.env.GOOGLE_CLOUD_PROJECT || 'url-redirector-479005';\n  const finalSecretName = secretName || process.env.GCP_SECRET_NAME || 'url-redirector-dotenv';\n  const name = `projects/${finalProjectId}/secrets/${finalSecretName}/versions/latest`;\n\n  try {\n    const [version] = await client.accessSecretVersion({ name });\n    const secretPayload = version.payload?.data?.toString();\n\n    if (!secretPayload) {\n      throw new Error('Secret payload is empty');\n    }\n\n    const envConfig = dotenv.parse(secretPayload);\n    for (const k in envConfig) {\n      process.env[k] = envConfig[k];\n    }\n    return envConfig;\n\n  } catch (error: unknown) {\n    const err = error as SecretManagerError;\n    // --- ADC GUARD CLAUSE ---\n    // Check for common credential errors (Missing ADC, invalid paths, or gRPC Unauthenticated)\n    if (\n      err.message.includes('Could not load the default credentials') ||\n      err.message.includes('no credentials found') ||\n      err.code === 16 // gRPC status for UNAUTHENTICATED\n    ) {\n      errorLog('\\n\\x1b[31m%s\\x1b[0m', 'ERROR: Google Cloud Credentials not found or invalid.'); // Red text\n      errorLog('The script cannot access Secret Manager without authentication.');\n      errorLog('\\nPlease run the following command to log in:');\n      errorLog('\\x1b[36m%s\\x1b[0m', '  gcloud auth application-default login'); // Cyan text\n      errorLog('\\nOr set GOOGLE_APPLICATION_CREDENTIALS to your key file path.\\n');\n      exit(1); // Exit gracefully\n      return;\n    }\n\n    // If it's a different error (e.g., Secret doesn't exist, Permission Denied), rethrow it\n    throw error;\n  }\n}"],"mappings":";;;;;;AAAA,IAAAA,cAAA,GAAAC,OAAA;AACA,IAAAC,OAAA,GAAAC,sBAAA,CAAAF,OAAA;AAA4B,SAAAE,uBAAAC,CAAA,WAAAA,CAAA,IAAAA,CAAA,CAAAC,UAAA,GAAAD,CAAA,KAAAE,OAAA,EAAAF,CAAA;AAerB,eAAeG,cAAcA,CAACC,SAAkB,EAAEC,UAAmB,EAAEC,OAA8B,GAAG,CAAC,CAAC,EAAiD;EAChK,MAAM;IAAEC,IAAI,GAAG,CAAC;EAAE,CAAC,GAAGD,OAAO;EAC7B,MAAME,MAAM,GAAGD,IAAI,CAACE,0BAA0B,IAAIA,yCAA0B;EAC5E,MAAMC,GAAG,GAAGH,IAAI,CAACG,GAAG,IAAIC,OAAO,CAACD,GAAG;EACnC,MAAME,QAAQ,GAAGL,IAAI,CAACM,KAAK,IAAIF,OAAO,CAACE,KAAK;EAC5C,MAAMC,IAAI,GAAGP,IAAI,CAACO,IAAI,IAAIC,OAAO,CAACD,IAAI;EAEtC,MAAME,MAAM,GAAG,IAAIR,MAAM,CAAC,CAAC;EAE3B,MAAMS,cAAc,GAAGb,SAAS,IAAIW,OAAO,CAACG,GAAG,CAACC,oBAAoB,IAAI,uBAAuB;EAC/F,MAAMC,eAAe,GAAGf,UAAU,IAAIU,OAAO,CAACG,GAAG,CAACG,eAAe,IAAI,uBAAuB;EAC5F,MAAMC,IAAI,GAAG,YAAYL,cAAc,YAAYG,eAAe,kBAAkB;EAEpF,IAAI;IAAA,IAAAG,gBAAA;IACF,MAAM,CAACC,OAAO,CAAC,GAAG,MAAMR,MAAM,CAACS,mBAAmB,CAAC;MAAEH;IAAK,CAAC,CAAC;IAC5D,MAAMI,aAAa,IAAAH,gBAAA,GAAGC,OAAO,CAACG,OAAO,cAAAJ,gBAAA,gBAAAA,gBAAA,GAAfA,gBAAA,CAAiBK,IAAI,cAAAL,gBAAA,uBAArBA,gBAAA,CAAuBM,QAAQ,CAAC,CAAC;IAEvD,IAAI,CAACH,aAAa,EAAE;MAClB,MAAM,IAAII,KAAK,CAAC,yBAAyB,CAAC;IAC5C;IAEA,MAAMC,SAAS,GAAGC,eAAM,CAACC,KAAK,CAACP,aAAa,CAAC;IAC7C,KAAK,MAAMQ,CAAC,IAAIH,SAAS,EAAE;MACzBhB,OAAO,CAACG,GAAG,CAACgB,CAAC,CAAC,GAAGH,SAAS,CAACG,CAAC,CAAC;IAC/B;IACA,OAAOH,SAAS;EAElB,CAAC,CAAC,OAAOlB,KAAc,EAAE;IACvB,MAAMsB,GAAG,GAAGtB,KAA2B;IACvC;IACA;IACA,IACEsB,GAAG,CAACC,OAAO,CAACC,QAAQ,CAAC,wCAAwC,CAAC,IAC9DF,GAAG,CAACC,OAAO,CAACC,QAAQ,CAAC,sBAAsB,CAAC,IAC5CF,GAAG,CAACG,IAAI,KAAK,EAAE,CAAC;IAAA,EAChB;MACA1B,QAAQ,CAAC,qBAAqB,EAAE,uDAAuD,CAAC,CAAC,CAAC;MAC1FA,QAAQ,CAAC,iEAAiE,CAAC;MAC3EA,QAAQ,CAAC,+CAA+C,CAAC;MACzDA,QAAQ,CAAC,mBAAmB,EAAE,yCAAyC,CAAC,CAAC,CAAC;MAC1EA,QAAQ,CAAC,kEAAkE,CAAC;MAC5EE,IAAI,CAAC,CAAC,CAAC,CAAC,CAAC;MACT;IACF;;IAEA;IACA,MAAMD,KAAK;EACb;AACF","ignoreList":[],"sourceRoot":""},"url":null}}}